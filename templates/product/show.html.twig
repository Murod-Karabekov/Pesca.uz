{% extends 'base.html.twig' %}

{% block title %}{{ product.name }} — Pesca{% endblock %}

{% block body %}
<section class="py-12 md:py-16">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        {# ─── Breadcrumb ─── #}
        <nav class="mb-8 text-sm text-brand-medium">
            <a href="{{ path('app_product_index') }}" class="hover:text-peach-600 transition-colors">Kolleksiya</a>
            <span class="mx-2">→</span>
            <span class="text-brand-dark">{{ product.name }}</span>
        </nav>

        <div class="grid md:grid-cols-2 gap-10 lg:gap-16">
            {# ─── Product Image ─── #}
            <div class="aspect-[3/4] bg-beige-100 rounded-2xl overflow-hidden">
                {% if product.imageSrc %}
                    <img src="{{ product.imageSrc }}" alt="{{ product.name }}"
                         class="w-full h-full object-cover">
                {% else %}
                    <div class="w-full h-full flex items-center justify-center">
                        <svg class="w-24 h-24 text-beige-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                    </div>
                {% endif %}
            </div>

            {# ─── Product Info ─── #}
            <div class="flex flex-col justify-center space-y-6">
                <div>
                    <h1 class="text-3xl md:text-4xl font-display font-bold text-brand-dark mb-3">{{ product.name }}</h1>
                    <p class="text-2xl font-display font-bold text-peach-600">{{ product.price|number_format(0, '.', ' ') }} so'm</p>
                </div>

                {% if product.description %}
                <div class="text-brand-medium leading-relaxed">
                    {{ product.description|nl2br }}
                </div>
                {% endif %}

                {# ─── Add to Cart Form ─── #}
                {% if app.user %}
                <form method="post" action="{{ path('app_cart_add', {id: product.id}) }}" class="space-y-6">
                    <input type="hidden" name="_token" value="{{ csrf_token('cart_add_' ~ product.id) }}">

                    <div>
                        <label class="block text-sm font-medium text-brand-dark mb-3">O'lcham tanlang</label>
                        <div class="flex flex-wrap gap-3">
                            {% for s in product.size %}
                            <label class="cursor-pointer">
                                <input type="radio" name="size" value="{{ s }}" class="sr-only peer" {% if loop.first %}checked{% endif %}>
                                <span class="inline-flex items-center justify-center w-14 h-14 rounded-xl border-2 border-beige-300 text-sm font-medium text-brand-medium
                                             peer-checked:border-peach-500 peer-checked:bg-peach-50 peer-checked:text-peach-700
                                             hover:border-peach-300 transition-all duration-200">
                                    {{ s }}
                                </span>
                            </label>
                            {% endfor %}
                        </div>
                    </div>

                    <button type="submit" class="btn-primary w-full md:w-auto text-base px-10 py-4">
                        Savatga qo'shish
                    </button>
                </form>
                {% else %}
                <div class="p-6 bg-beige-50 rounded-2xl border border-beige-200">
                    <p class="text-brand-medium mb-4">Savatga mahsulot qo'shish uchun tizimga kiring.</p>
                    <a href="{{ path('app_login') }}" class="btn-primary">Xarid uchun kiring</a>
                </div>
                {% endif %}

                {# ─── Product Details ─── #}
                <div class="border-t border-beige-200 pt-6 space-y-3">
                    <div class="flex items-center gap-3 text-sm text-brand-medium">
                        <svg class="w-5 h-5 text-peach-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </svg>
                        Premium sifatli materiallar
                    </div>
                    <div class="flex items-center gap-3 text-sm text-brand-medium">
                        <svg class="w-5 h-5 text-peach-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </svg>
                        Professional tibbiy standart
                    </div>
                    <div class="flex items-center gap-3 text-sm text-brand-medium">
                        <svg class="w-5 h-5 text-peach-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </svg>
                        Mavjud o'lchamlar: {{ product.size|join(', ') }}
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
